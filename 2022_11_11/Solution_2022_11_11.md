# 题目
https://atcoder.jp/contests/abc140/tasks/abc140_e
## 描述
输入 n(≤1e5) 和一个 1~n 的排列 p。
输出 p 中所有长度至少为 2 的子数组的第二大元素的和。
## 题解
* 对于这类子数组类的问题，普遍采取**贡献法**去解决问题。
* 对每个 p[i]，求上个、上上个、下个、下下个更大元素的位置，分别记作 L LL R RR。那么 p[i] 对答案的贡献为 p[i] * ((L-LL)*(R-i) + (RR-R)*(i-L))。
* 所以说该题的关键就是求这4个值。
### 方法1
* 类似[2454. 下一个更大元素 IV](https://leetcode.cn/problems/next-greater-element-iv/),用两个单调栈来解决问题。

[代码](./Solution_2022_11_11_1.java)
### 方法2
* 考虑到该题是排列，所以不需要单调栈。
* 用双向链表思考（实现时用的数组）：
把 p 转换成双向链表，按元素值从小到大遍历 p[i]，那么方法一中的 4 个位置就是 p[i] 左边两个节点和右边两个节点。
算完 p[i] 后把 p[i] 从链表中删掉。
* 这里又产生了一个新的知识点：[以数组来存双向链表](../knowledge_points/points_1.java)

[代码](./Solution_2022_11_11_2.java)